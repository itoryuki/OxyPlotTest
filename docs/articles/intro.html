<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>WPF/XAML&#12391;&#24115;&#31080;&#12398;&#12487;&#12470;&#12452;&#12531;&#12539;&#21360;&#21047;&#12434;&#34892;&#12358; </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="WPF/XAML&#12391;&#24115;&#31080;&#12398;&#12487;&#12470;&#12452;&#12531;&#12539;&#21360;&#21047;&#12434;&#34892;&#12358; ">
    <meta name="generator" content="docfx 2.5.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
              <h1 id="wpfxamlで帳票のデザイン印刷を行う" sourcefile="articles/intro.md" sourcestartlinenumber="1" sourceendlinenumber="1">WPF/XAMLで帳票のデザイン・印刷を行う</h1>
              
<p sourcefile="articles/intro.md" sourcestartlinenumber="3" sourceendlinenumber="3">※これは <a href="http://qiita.com/advent-calendar/2016/xaml" sourcefile="articles/intro.md" sourcestartlinenumber="3" sourceendlinenumber="3">XAML Advent Calendar 2016</a> の25日目の記事です。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="5" sourceendlinenumber="5">WPF/XAML を使って帳票のデザインから印刷までやってみたという話です。ソースコードが GitHub にありますので、それと同様にやればできます。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="7" sourceendlinenumber="7"><a href="https://github.com/vain0/VainZero.WpfReportPrinting" sourcefile="articles/intro.md" sourcestartlinenumber="7" sourceendlinenumber="7">vain0/VainZero.WpfReportPrinting: WPFで帳票を作成するサンプル</a></p>
<h2 id="要約" sourcefile="articles/intro.md" sourcestartlinenumber="9" sourceendlinenumber="9">要約</h2>
<ul sourcefile="articles/intro.md" sourcestartlinenumber="10" sourceendlinenumber="12">
<li sourcefile="articles/intro.md" sourcestartlinenumber="10" sourceendlinenumber="10">XAML というマークアップ言語で帳票のデザインを作りたいと思った。</li>
<li sourcefile="articles/intro.md" sourcestartlinenumber="11" sourceendlinenumber="11">WPF アプリケーションで帳票のプレビューや印刷を行うサンプルを作った。</li>
<li sourcefile="articles/intro.md" sourcestartlinenumber="12" sourceendlinenumber="12">ページネーションが大変だったけどなんとかなった。</li>
</ul>
<h2 id="前提知識" sourcefile="articles/intro.md" sourcestartlinenumber="14" sourceendlinenumber="14">前提知識</h2>
<p sourcefile="articles/intro.md" sourcestartlinenumber="15" sourceendlinenumber="15">XAML、WPF について簡単に説明します。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="17" sourceendlinenumber="17">XAML とは、GUIアプリケーションの外観を記述するマークアップ言語です。WEB 系の人には「HTML+CSS みたいなもの」といえばイメージしやすいのではないでしょうか。HTML と CSS の疎結合性を捨てた代わりに、テーブルレイアウトとかが標準でサポートされていて作りやすいなどの利点があります。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="19" sourceendlinenumber="19">WPF とは、XAML と .NET 言語 (C# など) を用いて、Windows PC 用のネイティヴ アプリケーションを作るためのフレームワークです。XAML は WPF 以外でも使いますが、筆者は WPF にしか詳しくないので、ひとまず本稿のターゲットは WPF のみとします。</p>
<h2 id="簡単な帳票" sourcefile="articles/intro.md" sourcestartlinenumber="21" sourceendlinenumber="21">簡単な帳票</h2>
<p sourcefile="articles/intro.md" sourcestartlinenumber="22" sourceendlinenumber="22">まずは簡単な帳票を例に挙げて、印刷する方法まで一通り解説します。簡単な帳票とは、タイトルがどーんとあって、日付が右寄せで、あとは本文という感じです。まずはプレビュー画面のスクリーンショットをご覧ください。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="24" sourceendlinenumber="24"><img src="../images/intro/HelloWorldReportScreenshot.png" alt="簡単な帳票のプレビュー画面" sourcefile="articles/intro.md" sourcestartlinenumber="24" sourceendlinenumber="24"></p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="26" sourceendlinenumber="26">ビューモデルと XAML は次のようになっています。UI要素はプレビュー用と印刷用の2つ (以上) をインスタンス化する必要があるので、 DataTemplate の形で定義しています。</p>
<pre sourcefile="articles/intro.md" sourcestartlinenumber="28" sourceendlinenumber="34"><code class="lang-csharp">// 印刷するページに対応するビューモデル。
// データをXAML側に埋め込んでしまったので中身がない。
public sealed class HelloWorldPageViewModel
{
}
</code></pre><pre sourcefile="articles/intro.md" sourcestartlinenumber="36" sourceendlinenumber="50"><code class="lang-xml">&lt;!--
    上記のビューモデルの表示方法を定義するテンプレート。
    Window.Resources プロパティの下に配置する。
--&gt;
&lt;DataTemplate DataType=&quot;{x:Type local:HelloWorldPageViewModel}&quot;&gt;
    &lt;Grid Margin=&quot;30&quot;&gt;
        &lt;StackPanel&gt;
            &lt;TextBlock HorizontalAlignment=&quot;Center&quot; FontSize=&quot;30&quot; Text=&quot;ハローワールド&quot; /&gt;
            &lt;TextBlock HorizontalAlignment=&quot;Right&quot; Text=&quot;2007/08/31&quot; /&gt;
            &lt;TextBlock Text=&quot;Hello, world!&quot; /&gt;
        &lt;/StackPanel&gt;
    &lt;/Grid&gt;
&lt;/DataTemplate&gt;
</code></pre><h3 id="プレビュー" sourcefile="articles/intro.md" sourcestartlinenumber="52" sourceendlinenumber="52">プレビュー</h3>
<p sourcefile="articles/intro.md" sourcestartlinenumber="53" sourceendlinenumber="53">帳票のデザインが終わったので、次はプレビューです。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="55" sourceendlinenumber="55">プレビューは、簡単にいえば、上に書いた XAML を「紙っぽいパネル」に載せるだけです。紙っぽさの演出についてはソースコードを参照してください。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="57" sourceendlinenumber="57">ここで重要なのは紙のサイズ (A4 とか) です。というのも、ページネーションや文章の折り返しなどが用紙サイズに依存してしまうため、プレビュー時点で用紙サイズを決定しておくのが無難です。(もちろんプレビューをしないというのも1つの手です。)</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="59" sourceendlinenumber="59">用紙サイズ (mm 単位) から要素のサイズを換算するには、dpi を知る必要がありますが、ここで嬉しいお知らせがあります。後述するように、印刷時にはUI要素を FixedDocument というクラスの子孫要素に配置するのですが、FixedDocument の中身は 96dpi で固定されます。すなわち、FixedDocument の中身 (印刷するデータ) を 96dpi 決め打ちで作成しておけば、その FixedDocument を 600dpi のレーザープリンターに送信しても、同じ見栄えのものが印刷されるようになっています。 (参考: <a href="https://msdn.microsoft.com/ja-jp/library/ms748388%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396" sourcefile="articles/intro.md" sourcestartlinenumber="59" sourceendlinenumber="59">WPF のドキュメント</a>)</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="61" sourceendlinenumber="61">要するに、印刷するデータは 96dpi で作ればよいわけです。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="63" sourceendlinenumber="63">例えば A4 (縦) は、ISO 規格で 210mm×297mm と決まっており、1 inch = 25.40 mm 、1 inch = 96 pixel で換算すれば 793.70×1122.52 となります。このサイズで作った紙風のパネルにページの中身を配置すれば、実際に印刷されるのと同じ見栄えのプレビューを表示できます。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="65" sourceendlinenumber="65">次は印刷です。</p>
<h3 id="プリンターの選択" sourcefile="articles/intro.md" sourcestartlinenumber="67" sourceendlinenumber="67">プリンターの選択</h3>
<p sourcefile="articles/intro.md" sourcestartlinenumber="68" sourceendlinenumber="68">どのプリンターで印刷するかは、ユーザーに選択させる方法と、プログラム側で指定する方法の2通りがあります。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="70" sourceendlinenumber="70">ユーザーに選択させる場合は、 <code>System.Windows.Controls</code> 名前空間の <code>PrintDialog</code> クラスを使います。(参考: <a href="https://msdn.microsoft.com/ja-jp/library/system.windows.controls.printdialog%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396" sourcefile="articles/intro.md" sourcestartlinenumber="70" sourceendlinenumber="70">PrintDialog クラス (System.Windows.Controls)</a>)</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="72" sourceendlinenumber="72">なお、プレビュー画面で選択された用紙サイズを印刷ダイアログの初期設定値にする方法は <del>時間が足りず調べられていません</del> 読者の演習課題とします。</p>
<pre sourcefile="articles/intro.md" sourcestartlinenumber="74" sourceendlinenumber="89"><code class="lang-csharp">using System.Windows.Controls;

{
    var printDialog = new PrintDialog();
    var result = printDialog.ShowDialog();
    if (!result.HasValue || !result.Value)
    {
        // 印刷ダイアログがキャンセルされた。
        return;
    }

    // 後の工程で使用する。
    var queue = printDialog.PrintQueue;
}
</code></pre><p sourcefile="articles/intro.md" sourcestartlinenumber="91" sourceendlinenumber="91">プログラム側で指定する場合は、プリントサーバーというのを使用するようです。詳しくは読者の演習課題とします。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="93" sourceendlinenumber="93">ここでは、コンピューター自身を表すサーバー (localhost みたいなもの) である <code>LocalPrintServer</code> から、デフォルトのプリンターを指定する方法をとります。</p>
<pre sourcefile="articles/intro.md" sourcestartlinenumber="95" sourceendlinenumber="110"><code class="lang-csharp">// System.Printing を参照に追加する必要があります。
using System.Printing;

public void Print(Size pageSize)
{
    var printServer = new LocalPrintServer();

    // 既定のプリンターを表す PrintQueue を取得する。
    var queue = printServer.DefaultPrintQueue;

    // プレビュー画面で用紙サイズを選択させる場合は、用紙サイズを設定しておく。
    var ticket = queue.PrintTicket;
    ticket.PageMediaSize = new PageMediaSize(pageSize.Width, pageSize.Height);;
}
</code></pre><h3 id="fixeddocument-の生成" sourcefile="articles/intro.md" sourcestartlinenumber="112" sourceendlinenumber="112">FixedDocument の生成</h3>
<p sourcefile="articles/intro.md" sourcestartlinenumber="113" sourceendlinenumber="113">先述の通り、印刷するデータを持つ FixedDocument のインスタンスを用意します。この作業は再利用可能な形式にしてあります。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="115" sourceendlinenumber="115">まず「印刷するデータを複数のページに分割する」機能 (ページネーション) を提供するインターフェイスを定義しておきます。<code>IPaginatable</code> と呼びましょう。</p>
<pre sourcefile="articles/intro.md" sourcestartlinenumber="117" sourceendlinenumber="128"><code class="lang-csharp">using System.Windows;

public interface IPaginatable
{
    /// &lt;summary&gt;
    /// ページのサイズを受け取って、オブジェクトのリストを返す。
    /// リストに含まれる各オブジェクトは、それぞれ1つのページの中身を表す。
    /// &lt;/summary&gt;
    IReadOnlyList&lt;object&gt; Paginate(Size pageSize);
}
</code></pre><p sourcefile="articles/intro.md" sourcestartlinenumber="130" sourceendlinenumber="130">いま例にとっているハローワールド帳票では、常に1つのページになりますので、Paginate メソッドは1つのオブジェクトを返せばよいわけです。次のようになります。 [^ireport]</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="132" sourceendlinenumber="132">[^ireport]: GitHub においてあるソースコードでは、HelloWorldReport は IPaginatable だけでなく、IPaginatable を拡張する IReport というインターフェイスを実装していますが、それはサンプルのためです。あまり気にしなくてかまいません。</p>
<pre sourcefile="articles/intro.md" sourcestartlinenumber="134" sourceendlinenumber="149"><code class="lang-csharp">public sealed class HelloWorldReport
    : IPaginatable
{
    IReadOnlyList&lt;object&gt; Pages { get; } =
        new object[]
        {
            new HelloWorldPageViewModel(),
        };

    public IReadOnlyList&lt;object&gt; Paginate(Size size)
    {
        return Pages;
    }
}
</code></pre><p sourcefile="articles/intro.md" sourcestartlinenumber="151" sourceendlinenumber="151">あとは次の拡張メソッドを呼ぶだけです。</p>
<pre sourcefile="articles/intro.md" sourcestartlinenumber="153" sourceendlinenumber="192"><code class="lang-csharp">public static class PaginatableExtension
{
    public static FixedDocument
        ToFixedDocument(this IPaginatable paginatable, Size pageSize)
    {
        var document = new FixedDocument();

        foreach (var content in paginatable.Paginate(pageSize))
        {
            var presenter =
                new ContentPresenter()
                {
                    Content = content,
                    Width = pageSize.Width,
                    Height = pageSize.Height,
                };

            var page =
                new FixedPage()
                {
                    Width = pageSize.Width,
                    Height = pageSize.Height,
                };
            page.Children.Add(presenter);

            // この3つを行わないと DataGrid がページ全体に展開せず、潰れた状態になる。
            // これらが実際に何をするかは余裕があったら調べたい。
            page.Measure(pageSize);
            page.Arrange(new Rect(new Point(0, 0), pageSize));
            page.UpdateLayout();

            var pageContent = new PageContent() { Child = page };
            document.Pages.Add(pageContent);
        }

        return document;
    }
}
</code></pre><p sourcefile="articles/intro.md" sourcestartlinenumber="194" sourceendlinenumber="194">このメソッドは、Paginate メソッドが返したリストの各要素につき、それを固定サイズの ContentPresenter に入れて、それを FixedPage に入れて、それを PageContent に入れて、それを FixedDocument に入れる、という感じです。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="196" sourceendlinenumber="196">こうして FixedDocument を手に入れました。</p>
<h3 id="xpsdocumentwriter-で印刷する" sourcefile="articles/intro.md" sourcestartlinenumber="198" sourceendlinenumber="198">XpsDocumentWriter で印刷する</h3>
<p sourcefile="articles/intro.md" sourcestartlinenumber="199" sourceendlinenumber="199">最後に、この FixedDocument を、選択されたプリンターに送信すれば完了です。</p>
<pre sourcefile="articles/intro.md" sourcestartlinenumber="201" sourceendlinenumber="209"><code class="lang-csharp">// System.Printing の参照を追加する必要があります。
using System.Printing;

{
    var writer = PrintQueue.CreateXpsDocumentWriter(queue);
    writer.Write(document);
}
</code></pre><p sourcefile="articles/intro.md" sourcestartlinenumber="211" sourceendlinenumber="211">できました。</p>
<h2 id="複数ページの帳票" sourcefile="articles/intro.md" sourcestartlinenumber="213" sourceendlinenumber="213">複数ページの帳票</h2>
<p sourcefile="articles/intro.md" sourcestartlinenumber="214" sourceendlinenumber="214">次に複雑な帳票、というかページネーションの方法を解説します。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="216" sourceendlinenumber="216">まずはプレビュー画面のスクリーンショットをごらんください。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="218" sourceendlinenumber="218"><img src="../images/intro/OrderFormScreenshot.png" alt="ページネーションを含む帳票のスクリーンショット" sourcefile="articles/intro.md" sourcestartlinenumber="218" sourceendlinenumber="218"></p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="220" sourceendlinenumber="220">XAML は結構な分量なので省略します。表の部分には、スタイルをガチガチに決めた DataGrid を使用しています。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="222" sourceendlinenumber="222">簡単な帳票との差は、Paginate メソッドの実装だけです。</p>
<h3 id="paginate" sourcefile="articles/intro.md" sourcestartlinenumber="224" sourceendlinenumber="224">Paginate</h3>
<p sourcefile="articles/intro.md" sourcestartlinenumber="225" sourceendlinenumber="225">ここでは実際に DataGrid をインスタンス化することでページネーションを行います。(というか、それ以外にうまい方法があるのでしょうか。)</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="227" sourceendlinenumber="227">おおまかな手順は次の通りです。</p>
<ol sourcefile="articles/intro.md" sourcestartlinenumber="229" sourceendlinenumber="231">
<li sourcefile="articles/intro.md" sourcestartlinenumber="229" sourceendlinenumber="229">すべての行のデータを持った DataGrid を生成する。</li>
<li sourcefile="articles/intro.md" sourcestartlinenumber="230" sourceendlinenumber="230">「スクロールなしで見えている行の数」を数えて、その範囲の行からなるページを生成する。</li>
<li sourcefile="articles/intro.md" sourcestartlinenumber="231" sourceendlinenumber="231">1ページ分スクロールして、また「見えている行の数」を数える。繰り返し。</li>
</ol>
<p sourcefile="articles/intro.md" sourcestartlinenumber="233" sourceendlinenumber="233">実際のソースコードはやや長いので、最初に張ったリンクから見てもらえればと思います。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="235" sourceendlinenumber="235">注意点は2つあります。</p>
<ul sourcefile="articles/intro.md" sourcestartlinenumber="237" sourceendlinenumber="237">
<li sourcefile="articles/intro.md" sourcestartlinenumber="237" sourceendlinenumber="237">DataGrid を初期化した後、画面サイズに合わせてレイアウトを再計算させる必要がある。</li>
</ul>
<pre sourcefile="articles/intro.md" sourcestartlinenumber="239" sourceendlinenumber="254"><code class="lang-csharp">    // ページネーションを行うために、実際に DataGrid を生成する。
    var preview = new OrderFormPage(Header, Items);
    var presenter =
        new ContentPresenter()
        {
            Content = preview,
            Width = size.Width,
            Height = size.Height,
        };

    // DataGrid のレイアウトを計算させる魔法のコード
    presenter.Measure(size);
    presenter.Arrange(new Rect(new Point(0, 0), size));
    presenter.UpdateLayout();
</code></pre><p sourcefile="articles/intro.md" sourcestartlinenumber="256" sourceendlinenumber="256">Measure, Arrange, UpdateLayout の3つを起動することで、DataGrid が余白に合わせて適切なサイズに広がります。</p>
<ul sourcefile="articles/intro.md" sourcestartlinenumber="258" sourceendlinenumber="258">
<li sourcefile="articles/intro.md" sourcestartlinenumber="258" sourceendlinenumber="258">「見えている行の数」の代わりに、「見える行数の最大値」である <code>ScrollViewer.ViewportHeight</code> が使用できる。(「見えている行の数」を厳密に取得する方法 <del>が分からなかった……</del> は読者の演習課題)</li>
</ul>
<p sourcefile="articles/intro.md" sourcestartlinenumber="260" sourceendlinenumber="260">DataGrid のデフォルトの見た目では、中身をスクロールできるように ScrollViewer が配置されていて、「見える行数の最大値」のような情報を取得するには、それのプロパティを見ればいいわけです。問題となるのは、ScrollViewer のインスタンスをどう捕まえるかなのですが、VisualTree を辿るのが1つの方法です。これについては、参考リンクにあるブログ記事を参照してください。(あるいはソースコードを参照。)</p>
<h2 id="おわりに" sourcefile="articles/intro.md" sourcestartlinenumber="262" sourceendlinenumber="262">おわりに</h2>
<p sourcefile="articles/intro.md" sourcestartlinenumber="263" sourceendlinenumber="263">いかがでしたでしょうか。不明点などあればコメントないし <a href="https://github.com/vain0/VainZero.WpfReportPrinting/issues" sourcefile="articles/intro.md" sourcestartlinenumber="263" sourceendlinenumber="263">Issue</a> をお願いします。</p>
<p sourcefile="articles/intro.md" sourcestartlinenumber="265" sourceendlinenumber="265">動かなかったらごめんなさい！</p>
<h2 id="参考リンク" sourcefile="articles/intro.md" sourcestartlinenumber="267" sourceendlinenumber="267">参考リンク</h2>
<h3 id="帳票関連" sourcefile="articles/intro.md" sourcestartlinenumber="268" sourceendlinenumber="268">帳票関連</h3>
<ul sourcefile="articles/intro.md" sourcestartlinenumber="269" sourceendlinenumber="269">
<li sourcefile="articles/intro.md" sourcestartlinenumber="269" sourceendlinenumber="269"><a href="http://koty.hatenablog.com/entry/2013/12/15/122352" sourcefile="articles/intro.md" sourcestartlinenumber="269" sourceendlinenumber="269">WPFを帳票フレームワークとして使う - @kotyのブログ</a></li>
</ul>
<h3 id="wpf関連" sourcefile="articles/intro.md" sourcestartlinenumber="271" sourceendlinenumber="271">WPF関連</h3>
<ul sourcefile="articles/intro.md" sourcestartlinenumber="272" sourceendlinenumber="273">
<li sourcefile="articles/intro.md" sourcestartlinenumber="272" sourceendlinenumber="272"><a href="http://stackoverflow.com/a/7601504/6419575" sourcefile="articles/intro.md" sourcestartlinenumber="272" sourceendlinenumber="272">c# - Check visible rows in a WPF DataGrid - Stack Overflow</a></li>
<li sourcefile="articles/intro.md" sourcestartlinenumber="273" sourceendlinenumber="273"><a href="http://blog.xin9le.net/entry/2013/10/29/222336" sourcefile="articles/intro.md" sourcestartlinenumber="273" sourceendlinenumber="273">VisualTreeの子孫要素を取得する - xin9le.net</a></li>
</ul>

            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/vain0/VainZero.WpfReportPrinting/blob/x/document/articles/intro.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2015-2016 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
